{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SESI - Login/Cadastro</title>
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
</head>
<body>
    <div class="container">
        <!-- Lado Esquerdo -->
        <div class="left-side">
            <div class="sesi-logo">
                <h1>SESI</h1>
            </div>
            <div class="hero-content">
                <div class="hero-image"></div>
            </div>
            <div class="decorative-elements">
                <div class="shape shape1"></div>
                <div class="shape shape2"></div>
                <div class="shape shape3"></div>
            </div>
        </div>
        <!-- Lado Direito -->
        <div class="right-side">
            <div class="form-container">
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
                <!-- Tabs -->
                <div class="form-tabs">
                    <button type="button" class="tab-button active" onclick="showTab(event, 'login')">Entrar</button>
                    <button type="button" class="tab-button" onclick="showTab(event, 'cadastrar')">Cadastrar</button>
                </div>
                <!-- Formulário de Login -->
                <div id="login" class="form-content active">
                    <h2 class="form-title">Bem-vindo de volta!</h2>
                    <p class="form-subtitle">Insira suas credenciais para acessar sua conta</p>
                    <form method="post" action="{% url 'login_cadastro' %}">
                        {% csrf_token %}
                        <div class="input-group">
                            <label for="login-cpf">CPF</label>
                            <input type="text" id="login-cpf" name="cpf" class="input-field" placeholder="000.000.000-00" required>
                        </div>
                        <div class="input-group">
                            <label for="login-password">Senha</label>
                            <input type="password" id="login-password" name="password" class="input-field" placeholder="Digite sua senha" required>
                        </div>
                        <button type="submit" name="login_submit" class="btn-primary">Entrar</button>
                    </form>
                    <div class="forgot-password">
                        <a href="#">Esqueceu sua senha?</a>
                    </div>
                    <div class="divider">
                        <span>ou continue com</span>
                    </div>
                    <div class="social-buttons">
                        <button class="btn-social" type="button">Google</button>
                        <button class="btn-social" type="button">Facebook</button>
                    </div>
                </div>
                <!-- Formulário de Cadastro -->
                <div id="cadastrar" class="form-content">
                    <h2 class="form-title">Crie sua conta</h2>
                    <p class="form-subtitle">Preencha os dados abaixo para começar</p>
                    <form method="post" action="{% url 'login_cadastro' %}">
                        {% csrf_token %}
                        {% if cadastro_form.non_field_errors %}
                            <div class="alert alert-danger">
                                {% for error in cadastro_form.non_field_errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                        {% for field in cadastro_form %}
                            <div class="input-group">
                                {{ field.label_tag }}
                                {{ field }}
                                {% if field.errors %}
                                    <div class="form-errors">{{ field.errors }}</div>
                                {% endif %}
                            </div>
                        {% endfor %}
                        <button type="submit" name="cadastro_submit" class="btn-primary">Cadastrar</button>
                    </form>
                    <div class="divider">
                        <span>ou cadastre-se com</span>
                    </div>
                    <div class="social-buttons">
                        <button class="btn-social" type="button">Google</button>
                        <button class="btn-social" type="button">Facebook</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function showTab(event, tabName) {
            document.querySelectorAll('.form-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
        }
        function formatCPF(input) {
            let value = input.value.replace(/\D/g, '');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            input.value = value;
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('login-cpf').addEventListener('input', function() { formatCPF(this); });
            const signupCpf = document.getElementById('id_cpf');
            if(signupCpf) signupCpf.addEventListener('input', function() { formatCPF(this); });
            
            // Animação
            const formContainer = document.querySelector('.form-container');
            formContainer.style.opacity = '0';
            formContainer.style.transform = 'translateY(20px)';
            setTimeout(() => {
                formContainer.style.transition = 'all 0.6s ease';
                formContainer.style.opacity = '1';
                formContainer.style.transform = 'translateY(0)';
            }, 100);

            // Manter a aba de cadastro ativa se houver erros
            {% if cadastro_form.errors %}
                showTab(null, 'cadastrar');
            {% endif %}
        });
    </script>
</body>
</html>
</body>
</html>
